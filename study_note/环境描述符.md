# 环境描述符的添加

## 高斯平滑 (Gaussian Smearing): 新增了 GaussianSmearing 类。这是一种在图神经网络（特别是处理分子/晶体）中常用的技术。

- 原理：它将两个原子之间的连续距离（Scalar distance）扩展为一组向量（Radial Basis Functions, RBF）。
- 作用：让神经网络更容易理解“距离”的细微变化。比如 1.5Å 和 1.6Å 的区别，通过 RBF 展开后会有明显的特征差异。

## 状态增强 (_augment_state): 你增加了一个私有方法 _augment_state，并在 reset 和 step 中调用它。

逻辑：它计算所有边的距离 -> 通过高斯平滑 -> 将边的特征聚合（Sum/Mean）到节点上 -> 拼接到原始节点特征 o.x 中。

效果：现在 Agent 不仅知道“我是碳原子”，还通过周围邻居的距离分布知道“我处于一个拥挤的环境”或“我处于表面”。

## 动态调整网络输入 (patch_irreps): 这是一个非常聪明的工程实现。因为你增加了输入特征维度（DESC_DIM），你需要修改 Actor 和 Critic 的输入层定义。

自动修补：你使用了正则表达式 (re) 动态修改 irreps_in 字符串（例如将 64x0e 自动改为 72x0e）。这兼容了 e3nn 或类似等变神经网络的配置格式，无需手动修改配置文件。

# 对比实验

## 原版

reward_func = hybrid ,weights=1,2,1

### 指标

- 达到收敛为1之下，需要将近4000步数
- 将近23轮次左右，极少触发stop_label

## 描述符版本

- 达到收敛为1之下，需要将近2600步数
- 第二轮左右，不在触发stop_label，后续步数跑满1000步，然后进入到收敛阈值0.01

### 描述符版本，weights=0.5,2,1。奖励函数优化

- 达到收敛[1,3]下，需要将近1300步数。收敛快速，但是轻微局部动荡
- 几乎不触发stop_label

# 备注

- 原版前期容易触发stop_label,同步数下轮次数高
